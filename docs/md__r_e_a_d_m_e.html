<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>rt1-assignment3: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Ros_logo.svg.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rt1-assignment3
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Third assignment for the Research Track 1 course</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Institution:</b> Università di Genova<br  />
 <b>Course:</b> MSc in Robotics Engineering<br  />
 <b>Subject:</b> Research Track 1<br  />
 <b>Author:</b> <em><b>Alex Thanaphon Leonardi</b></em><br  />
</p>
<h1><a class="anchor" id="autotoc_md0"></a>
Assignment 3</h1>
<h2><a class="anchor" id="autotoc_md1"></a>
Introduction</h2>
<p>This is the third assignment of the "Research Track 1" course, for the Robotics Engineering degree, Università di Genova. The assignment consists in writing two ROS nodes: a controller for a robot, and a UI. The user can choose one of three methods to command the robot (autonomously, manually, or in assisted driving mode). A helper node was also implemented to get input asynchronously, i.e. without blocking the main nodes.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Running the program</h2>
<h3><a class="anchor" id="autotoc_md3"></a>
Installation</h3>
<p>The simulator requires ROS. Clone this repository into your ROS workspace's src/ folder. </p><div class="fragment"><div class="line">git clone https://www.github.com/ThanaphonLeonardi/rt1-assignment3</div>
</div><!-- fragment --><p>It also requires the final_assignment package, the slam_gmapping package, and the ROS navigation stack </p><div class="fragment"><div class="line">git clone https://www.github.com/CarmineD8/final_assignment</div>
<div class="line">git clone https://www.github.com/CarmineD8/slam_gmapping</div>
<div class="line">sudo apt-get install ros-noetic-navigation</div>
</div><!-- fragment --><p>Make sure to switch to the noetic branch on the git repositories! </p>
<h3><a class="anchor" id="autotoc_md4"></a>
Execution</h3>
<p>Launch the simulation. </p><div class="fragment"><div class="line">roslaunch final_assignment simulation_gmapping.launch</div>
</div><!-- fragment --><p>And the node that manages the movement </p><div class="fragment"><div class="line">roslaunch final_assignment move_base.launch</div>
</div><!-- fragment --><p>Finally, run the controller, ui, helper, and teleop_twist_keyboard node </p><div class="fragment"><div class="line">roslaunch rt1-assignment3 rt1a3.launch</div>
<div class="line">roslaunch rt1-assignment3 rt1a3_teleop.launch</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md5"></a>
Description</h2>
<p>The robot can be controlled according to three modes:</p><ol type="1">
<li>Autonomous Drive: the robot can be given a pair of coordinates, towards which it will autonomously drive. The goal can be cancelled by pressing <b>q</b>.</li>
<li>Manual Drive: the robot can be manually controlled by an operator, using the <b>teleop_twist_keyboard</b> package. By choosing this option, the robot can be controlled via the terminal on which the rt1a3_teleop launch file was called, using the keys "uiojklm,.".</li>
<li>Assisted Drive: same as manual drive, except that the robot will now actively avoid all collisions, even superseding user input.</li>
</ol>
<h2><a class="anchor" id="autotoc_md6"></a>
Behind The Scenes</h2>
<p>The <b>UI</b> node sends relevant information to the <b>controller</b> node, through the use of topics. It also communicates directly with the <b>move_base</b> node if the user requests goal cancellation, to ensure speedy response. The <b>controller</b> node not only receives input from the <b>UI</b> node, but also from the <b>teleop_twist_keyboard</b> node, which no longer publishes directly to the <b>cmd_vel</b> topic, but rather is remapped to publish to the <b>controller_cmd_vel</b> topic. This way, the <b>controller</b> node has the ability to block commands as necessary (in case of autonomous drive) or to filter the commands before they are published to the robot (in case of assisted drive). The <b>UI</b> receives information from the <b>controller</b> node on the <b>controller_stateinfo</b> topic. This way, the user is always kept updated on the robot's state. Both nodes set and get parameters from the parameter server, that can be modified in the launch file.</p>
<h3><a class="anchor" id="autotoc_md7"></a>
Extras</h3>
<p>The <b>roslaunch</b> file is set by default to print to the terminal. The program is capable of <b>logging</b> and can be set to do so, to the default ROS logs, by modifying the launch file accordingly.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Node structure</h2>
<p>Image</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Pseudocode</h2>
<h3><a class="anchor" id="autotoc_md10"></a>
controller node</h3>
<div class="fragment"><div class="line">listen for UI node&#39;s commands</div>
<div class="line"> </div>
<div class="line">if autonomous drive</div>
<div class="line">  receive coordinates</div>
<div class="line">  start driving action with coordinates</div>
<div class="line"> </div>
<div class="line">elseif manual drive</div>
<div class="line">  redirect teleop_twist_keyboard node to cmd_vel topic</div>
<div class="line"> </div>
<div class="line">elseif assisted drive</div>
<div class="line">  run collision avoidance on teleop_twist_keyboard&#39;s commands</div>
<div class="line">  send filtered commands to cmd_vel</div>
<div class="line"> </div>
<div class="line">send info to UI node</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md11"></a>
user interface (ui) node</h3>
<div class="fragment"><div class="line">listen for input</div>
<div class="line"> </div>
<div class="line">while listening for input</div>
<div class="line"> </div>
<div class="line">  if key pressed == 1</div>
<div class="line">    ask user for coordinates</div>
<div class="line">    publish coordinates to controller</div>
<div class="line">    listen for input</div>
<div class="line">    while listening for input</div>
<div class="line">      if key pressed == q</div>
<div class="line">        cancel goal</div>
<div class="line">        exit</div>
<div class="line"> </div>
<div class="line">  elseif key pressed == 2</div>
<div class="line">    tell controller to go into manual drive mode</div>
<div class="line">    print controller output</div>
<div class="line"> </div>
<div class="line">  elseif key pressed == 3</div>
<div class="line">    tell controller to go into assisted drive mode</div>
<div class="line">    print controller output</div>
<div class="line"> </div>
<div class="line">  else</div>
<div class="line">    print &quot;wrong input&quot;</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
